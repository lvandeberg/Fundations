<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Letter Tray</title>

  <style>
    :root{
      --bg:#f7f8fb;
      --card:#ffffff;
      --border:#cfd6df;
      --border2:#d6dde6;
      --active:#7aa7ff;
      --shadow:0 2px 10px rgba(0,0,0,.06);
      --tile:68px;
      --gap:10px;
      --radius:16px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:#1f2937;
    }

    body{ margin:0; background:var(--bg); }
    header{
      padding:14px 18px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:var(--card);
      border-bottom:1px solid var(--border2);
      position:sticky;
      top:0;
      z-index:20;
      gap:12px;
      flex-wrap:wrap;
    }
    h1{ margin:0; font-size:16px; font-weight:650; }

    .btnRow{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
    button{
      padding:8px 14px;
      border-radius:10px;
      border:1px solid var(--border);
      background:var(--card);
      cursor:pointer;
      font-size:13px;
      box-shadow:var(--shadow);
      white-space:nowrap;
      touch-action: manipulation;
    }
    button.primary{
      border-color:#9bbcff;
      background:#f2f6ff;
    }
    button.toggled{
      border-color:#5b8cff;
      background:#eaf1ff;
    }

    main{
      padding:18px;
      max-width:1200px;
      margin:0 auto;
    }

    .sectionTitle{
      margin:0 0 10px 0;
      font-size:14px;
      font-weight:650;
    }
    .hint{
      font-size:12px;
      color:#6b7280;
      margin:4px 0 0 0;
      line-height:1.3;
    }

    .dropzone{
      background:var(--card);
      border:2px dashed var(--border);
      border-radius:var(--radius);
      padding:12px;
      min-height:120px;
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(var(--tile), var(--tile)));
      grid-auto-rows: var(--tile);
      gap: var(--gap);
      align-content:start;
      justify-content:start;
    }
    .dropzone.active{
      background:#f2f6ff;
      border-color:var(--active);
    }
    .tray{
      border-style:solid;
      border-width:2px;
    }

    .workWrap{
      position:relative;
    }
    #workspace{
      position:relative;
      z-index:1;
    }
    #inkCanvas{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      z-index:2;
      border-radius:var(--radius);
      pointer-events:none;
      touch-action:none;
    }

    .tile{
      width:var(--tile);
      height:var(--tile);
      border-radius:14px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:26px;
      font-weight:750;
      user-select:none;
      border:1px solid var(--border);
      box-shadow:0 1px 6px rgba(0,0,0,.08);
      cursor:grab;
      position:relative;
      overflow:hidden;
      touch-action:none;
    }
    .tile:active{ cursor:grabbing; }

    .tile.template::after{
      content:"";
      position:absolute;
      width:10px;
      height:10px;
      border-radius:999px;
      background:rgba(31,41,55,.25);
      top:8px;
      right:8px;
    }

    .vowel{ background:#f7c6c7; }
    .consonant{ background:#f9efc7; }
    .blend{ background:#f9efc7; }
    .ending{ background:#cfe9d6; }
    .breaker{ background:#eef2f7; }

    .workTools{
      margin:12px 0 8px 0;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .keyBox{
      margin-top:14px;
      padding:12px;
      border:1px solid var(--border);
      border-radius:14px;
      background:var(--card);
      box-shadow:var(--shadow);
    }
  </style>
</head>

<body>
<div id="fsWrap">
  <header>
    <h1>Letter Tray</h1>
    <div class="btnRow">
      <button id="fullscreenBtn">Full screen</button>
      <button id="clearWorkBtn">Clear workspace</button>
    </div>
  </header>

  <main>
    <section>
      <p class="sectionTitle">Tray</p>
      <p class="hint">Drag from the tray to create tiles. Drop tiles back here to remove them.</p>
      <div class="dropzone tray" id="tray"></div>
    </section>

    <section style="margin-top:14px;">
      <p class="sectionTitle">Workspace</p>
      <div class="workTools">
        <button id="dragBtn" class="primary toggled">Drag tiles</button>
        <button id="penBtn">Pen</button>
        <button id="eraserBtn">Eraser</button>
        <button id="clearInkBtn">Clear pen</button>
        <button id="addBreakBtn" class="primary">Add | break</button>
      </div>

      <div class="workWrap">
        <div class="dropzone workzone" id="workspace"></div>
        <canvas id="inkCanvas"></canvas>
      </div>
    </section>
  </main>
</div>

<script>
let mode = "drag"; // drag | pen | eraser

const TILE_DATA = [
  { id:"a", text:"a", type:"vowel" },
  { id:"b", text:"b", type:"consonant" },
  { id:"c", text:"c", type:"consonant" },
  { id:"d", text:"d", type:"consonant" },
  { id:"e", text:"e", type:"vowel" },
  { id:"f", text:"f", type:"consonant" },
  { id:"g", text:"g", type:"consonant" },
  { id:"h", text:"h", type:"consonant" },
  { id:"i", text:"i", type:"vowel" },
  { id:"j", text:"j", type:"consonant" },
  { id:"k", text:"k", type:"consonant" },
  { id:"l", text:"l", type:"consonant" },
  { id:"m", text:"m", type:"consonant" },
  { id:"n", text:"n", type:"consonant" },
  { id:"o", text:"o", type:"vowel" },
  { id:"p", text:"p", type:"consonant" },
  { id:"qu", text:"qu", type:"consonant" },
  { id:"r", text:"r", type:"consonant" },
  { id:"s", text:"s", type:"consonant" },
  { id:"t", text:"t", type:"consonant" },
  { id:"u", text:"u", type:"vowel" },
  { id:"v", text:"v", type:"consonant" },
  { id:"w", text:"w", type:"consonant" },
  { id:"x", text:"x", type:"consonant" },
  { id:"y", text:"y", type:"consonant" },
  { id:"z", text:"z", type:"consonant" },

  { id:"ch", text:"ch", type:"blend" },
  { id:"sh", text:"sh", type:"blend" },
  { id:"th", text:"th", type:"blend" },
  { id:"wh", text:"wh", type:"blend" },
  { id:"ck", text:"ck", type:"blend" },

  { id:"all", text:"all", type:"ending" },
  { id:"an", text:"an", type:"ending" },
  { id:"am", text:"am", type:"ending" },
  { id:"ang", text:"ang", type:"ending" },
  { id:"ing", text:"ing", type:"ending" },
  { id:"ong", text:"ong", type:"ending" },
  { id:"ung", text:"ung", type:"ending" },
  { id:"ank", text:"ank", type:"ending" },
  { id:"ink", text:"ink", type:"ending" },
  { id:"onk", text:"onk", type:"ending" },
  { id:"unk", text:"unk", type:"ending" }
];

const tray = document.getElementById("tray");
const workspace = document.getElementById("workspace");
const canvas = document.getElementById("inkCanvas");
const ctx = canvas.getContext("2d");

let draggedEl = null;
const defById = new Map(TILE_DATA.map(t => [t.id, t]));

function makeTile(def, template){
  const el = document.createElement("div");
  el.className = `tile ${def.type}` + (template ? " template" : "");
  el.textContent = def.text;
  el.draggable = true;
  el.dataset.template = template ? "1" : "0";
  el.dataset.tileId = def.id;

  el.addEventListener("dblclick", () => {
    if(el.dataset.template === "0") el.remove();
  });

  el.addEventListener("dragstart", e => {
    if(mode !== "drag") return;
    draggedEl = el;
    const payload = JSON.stringify({ tileId: def.id, template: el.dataset.template });
    e.dataTransfer.setData("text/plain", payload);
  });

  el.addEventListener("dragend", () => draggedEl = null);

  return el;
}

TILE_DATA.forEach(def => tray.appendChild(makeTile(def, true)));

[tray, workspace].forEach(zone => {
  zone.addEventListener("dragover", e => {
    if(mode !== "drag") return;
    e.preventDefault();
  });

  zone.addEventListener("drop", e => {
    if(mode !== "drag") return;
    e.preventDefault();
    const data = JSON.parse(e.dataTransfer.getData("text/plain"));
    if(zone === tray){
      if(draggedEl && draggedEl.dataset.template === "0") draggedEl.remove();
      return;
    }
    if(data.template === "1"){
      const def = defById.get(data.tileId);
      workspace.appendChild(makeTile(def, false));
    }else if(draggedEl){
      workspace.appendChild(draggedEl);
    }
  });
});

function resizeCanvas(){
  const r = canvas.getBoundingClientRect();
  const dpr = window.devicePixelRatio || 1;
  canvas.width = r.width * dpr;
  canvas.height = r.height * dpr;
  ctx.setTransform(dpr,0,0,dpr,0,0);
  ctx.lineCap = "round";
  ctx.lineJoin = "round";
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

let drawing=false, last=null;
function setMode(m){
  mode=m;
  canvas.style.pointerEvents = (m==="drag") ? "none" : "auto";
  document.getElementById("dragBtn").classList.toggle("toggled", m==="drag");
  document.getElementById("penBtn").classList.toggle("toggled", m==="pen");
  document.getElementById("eraserBtn").classList.toggle("toggled", m==="eraser");
  ctx.globalCompositeOperation = (m==="eraser") ? "destination-out" : "source-over";
  ctx.lineWidth = (m==="eraser") ? 18 : 4;
  ctx.strokeStyle = "#111827";
}

canvas.addEventListener("pointerdown", e=>{
  if(mode==="drag") return;
  drawing=true;
  last={x:e.offsetX,y:e.offsetY};
});
canvas.addEventListener("pointermove", e=>{
  if(!drawing) return;
  ctx.beginPath();
  ctx.moveTo(last.x,last.y);
  ctx.lineTo(e.offsetX,e.offsetY);
  ctx.stroke();
  last={x:e.offsetX,y:e.offsetY};
});
canvas.addEventListener("pointerup", ()=>drawing=false);
canvas.addEventListener("pointercancel", ()=>drawing=false);

document.getElementById("dragBtn").onclick=()=>setMode("drag");
document.getElementById("penBtn").onclick=()=>setMode("pen");
document.getElementById("eraserBtn").onclick=()=>setMode("eraser");
document.getElementById("clearInkBtn").onclick=()=>ctx.clearRect(0,0,canvas.width,canvas.height);
document.getElementById("clearWorkBtn").onclick=()=>{workspace.innerHTML="";ctx.clearRect(0,0,canvas.width,canvas.height);};

const fsBtn=document.getElementById("fullscreenBtn");
const fsWrap=document.getElementById("fsWrap");
fsBtn.onclick=async()=>{
  if(!document.fullscreenElement) await fsWrap.requestFullscreen();
  else await document.exitFullscreen();
};

setMode("drag");
</script>
</body>
</html>
